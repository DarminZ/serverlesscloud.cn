---
title: 【玩转云函数】腾讯云函数帮我定时和 HR 打招呼，找工作不再愁！
description: 用云函数 SCF 帮我跟 HR 打招呼。
date: 2021-07-20
thumbnail: https://main.qcloudimg.com/raw/203b813bfc0fe61f27fa7ff0ccdaca9b.jpg
categories:
  - best-practice
authors:
  - 任志伟
tags:
  - Serverless
  - 云函数
---

*以下内容来自「玩转腾讯云」用户原创文章，已获得授权。*

<img src="https://z3.ax1x.com/2021/06/30/RDauGD.png" width="700"/>



最近看很多人跑路，所以就想着造福自己，想去自动的在某招聘软件中跟 HR 打招呼，由于买个服务器来单独配个 corntab 确实有点浪费，所以就选择了云函数，毕竟云函数的免费额度够用了。

[![WJqPMQ.md.png](https://z3.ax1x.com/2021/07/19/WJqPMQ.md.png)](https://imgtu.com/i/WJqPMQ)

所以，开始吧！

## 01. 脚本编写

我使用的是 Node.js 进行编写，总共文件分为三个：

- common.js 存放公共的头部参数, 和公共方法
- request.js 用于请求接口
- index.js 用于云函数的触发器配置运行的文件

代码都没啥，就是带参数请求接口，公共参数，主要是配置请求的 header；

```js
const headers = {
  'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36 MicroMessenger/7.0.9.501 NetType/WIFI MiniProgramEnv/Windows WindowsWechat',
  'content-type': 'application/x-www-form-urlencoded',
  mpt: '',
  platform: '',
  scene: '',
  ua: '{"model":"microsoft"}',
  v: '',
  ver: '',
  wt2: '',
  zpAppId: '',
  Referer: '',
  'Accept-Encoding': 'gzip, deflate, br'
}

function sleep (delay) {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve()
    }, delay)
  })
}

exports.headers = headers

exports.sleep = sleep
```

接口请求，主要就是先获取指定城市的岗位列表，然后挨个打招呼；

```js
const got = require('got')
const fs = require('fs')
const { headers, sleep } = require('./common')

function getJobList(page = 1) {
  return got('自己去抓包哦', {
    method: 'GET',
    headers,
    searchParams: {
      appId: 10002,
      expectId: 185008765,
      sortType: 1,
      cityCode: 101020100,
      districtCode: '',
      businessCode: '',
      subwayLineId: '',
      subwayStationId: '',
      page: page,
      pageSize: 10,
      salary: '',
      degree: '',
      experience: '',
      stage: '',
      scale: '',
      industry: '',
      longitude: '',
      latitude: '',
      positionCode: ''
    }
  })
}

function addJob(jobId, lid, securityId) {
  const body = {
    appId: '',
    jobId: jobId,
    lid: lid,
    securityId: securityId
  }
  return got('自己去抓包哦', {
    method: 'POST',
    headers,
    body: new URLSearchParams(body).toString()
  }).then(res => {
    console.log(res.body)
    return res
  })
}

async function main () {
  try {
    let jobList = []
    for (let i = 1;;i++) {
      const res = await getJobList(i)
      const data = JSON.parse(res.body)
      jobList.push(...data.zpData.jobList)
      if (!data.zpData.hasMore) {
        break
      }
    }
    const asyncArr = []
    jobList.forEach(async job => {
      console.log(job.jobName)
      asyncArr.push(addJob(job.encryptJobId, job.lid, job.securityId))
    })
    Promise.all(asyncArr)
  } catch (error) {
    console.log(error)
  }
}

main()
```

然后就是获取触发器中附加信息的主函数，通过获取附加信息中写的文件名，来调用指定文件，因为我还有发简历的文件，所以要区分下；

```js
'use strict';
exports.main_handler = async (event, context, callback) => {
  for (const v of event["Message"].split("\r\n")) {
    console.log(v);
    require(`./${v}.js`)
  }
}
```



## 02. 创建云函数

1. 直接首页搜索`云函数`

![WJqirj.md.png](https://z3.ax1x.com/2021/07/19/WJqirj.md.png)





2. 进入 [云函数控制台](https://console.cloud.tencent.com/scf)

![WJqFqs.md.png](https://z3.ax1x.com/2021/07/19/WJqFqs.md.png)

3. 创建云函数，创建方式选择自定义创建，运行环境选择 Node.js，函数代码我们直接选择上传文件夹，方便快捷啊，把我们的代码文件夹直接选中上传即可；

![WJqSG8.md.png](https://z3.ax1x.com/2021/07/19/WJqSG8.md.png)

- 注意：这里的超时时间可以设置长一点，毕竟是接口请求，还是得花点时间的，设少了，还没请求完成，就给断了；

![WJbvIP.md.png](https://z3.ax1x.com/2021/07/19/WJbvIP.md.png)

4. 接下来，配置触发器，选择定时触发，我们可以选择它写死的一些时间点，例如每一分钟，每一天等，也可以使用自定义触发周期，自己配置cron表达式，例如每天晚上九点就是`0 0 9 * * * *`；

5. 最后，附加信息选择`是`，然后写我们要跑的文件名，即`request`

![WJbXVI.md.png](https://z3.ax1x.com/2021/07/19/WJbXVI.md.png)

![WJq9xg.md.png](https://z3.ax1x.com/2021/07/19/WJq9xg.md.png)

6. 点击「完成」即可创建云函数，随后我们可以在列表中，查看到我们的云函数，进入详情，也可以修改代码并部署。



## 03. 效果展示

![WJqDeA.png](https://z3.ax1x.com/2021/07/19/WJqDeA.png)

![WJbzPf.png](https://z3.ax1x.com/2021/07/19/WJbzPf.png)




## Web Function 体验官招募令

[**惊喜福利满满，点击查看活动详情**](https://mp.weixin.qq.com/s/YLIknQmXDKL9FzHEQlKQCQ)

<img src="https://main.qcloudimg.com/raw/545c2c8589959c675b8c501e8b41e363.png" width="700"/>



## **Web Function 使用体验**

- Web Function 产品文档：

  https://cloud.tencent.com/document/product/583/56123

- Web Function 快速体验链接：

  https://console.cloud.tencent.com/scf/list-create?rid=16&ns=default&keyword=WebFunc



当前已在国内各大区域发布上线，欢迎体验使用！

<img src="https://main.qcloudimg.com/raw/4ee70db1b518d4c0064711d1caf1572c.jpg" width="700"/>


---

> **传送门：**
>
> - GitHub: [github.com/serverless](https://github.com/serverless/serverless/blob/master/README_CN.md)
> - 官网：[serverless.com](https://serverless.com/)



欢迎访问：[Serverless 中文网](https://serverlesscloud.cn/)，您可以在 [最佳实践](https://serverlesscloud.cn/best-practice) 里体验更多关于 Serverless 应用的开发！
