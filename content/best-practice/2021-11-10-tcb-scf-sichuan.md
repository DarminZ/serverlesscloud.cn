---
title: 14 天上线，服务 1 亿用户：云开发高并发架构支撑四川天府健康通
description: 作为疫情防控的首要关卡，四川天府健康通的高并发架构，为美丽天府保驾护航。
date: 2021-11-10
thumbnail: https://qcloudimg.tencent-cloud.cn/raw/0c652c165b3bf1afe6c6d12a3c1933e5.jpg
categories:
  - best-practice
authors:
  - 刘传传
tags:
  - Serverless
  - 云函数
---



健康出行，“一码” 当先。国内外疫情反弹形势严峻，而即将到来的 2021 年末，元旦、春运等出行压力更是加重了各地健康码产品的承载和运行压力。作为疫情防控的首要关卡，四川天府健康通的高并发架构，为美丽天府保驾护航。

**1亿**

作为四川省政府新冠肺炎疫情防控的官方平台，**“四川天府健康通小程序”** 服务全省约 **1亿 +** 用户，是全国使用最广泛的健康码产品。

**6万**

四川天府健康通在春运返乡高峰期间，峰值 QPS 达到了 4万，而整套系统验证的峰值 QPS 可支撑 **6万 +** 高并发。

**14天**

基于云函数 SCF 底层算力，四川省大数据中心研发团队利用「腾讯云云开发+云函数+微搭低代码开发平台」，在 **14 天内** 实现了平台运行测试和上线，不仅包括健康码生码、亮码、判码等基础功能，还实现了家庭码、离线码、场所码、健康打卡、智能咨询、大数据精准防控等扩展功能。

<img src="https://qcloudimg.tencent-cloud.cn/raw/8716f016ecfcb98b91f237f68c176281.png" width="700"/>

（云函数 SCF 跨政务云等多后端，支撑四川天府健康通）



在技术实现上，基于腾讯云云函数 SCF 的弹性算力支持，前端采用微搭低码的可视化、组件化、低码化等能力，后端采用云数据库、云托管等云原生能力，同时通过云函数调用政务云等私有云的服务能力，充分发挥云函数 SCF 的高性能和低运维成本的 FaaS 能力优势。



## 01. 云函数+云开发+微搭，前后端分离解决方案

用户健康码查询需求和管理部门对健康码运行系统的监控需求，是健康码的两大基础功能。因此，健康码产品必须能够应对高并发场景，以响应各个地理位置各个终端的随时访问请求。本次四川天府健康通开发需求的主要特点是：

- **研发周期紧张**

成都市健康码面临海量的并发导致系统不可用，于是四川省政府当机立断，重塑全省统一的电子健康码，利用最先进的互联网架构搭建支持全省将近1亿用户的健康码，真正做到高可用、做到基于大数据的精准防控。因此，提出了 “奋战 14 天、一码走全川” 的工作目标。

- **并发要求高**

亮码查询区域广泛、人群流动频繁、使用频率高，需要支持大数据量下的高并发点查和低时延响应。

- **可用性要求高**

7 x 24 小时不间断地提供高稳定服务。

- **数据安全等级高**

信息查询的数据分布在不同职能部门，如红黄码信息由政务私有云提供，而地理信息由运营商提供。为提供统一分析查询，需要将各个数据源进行打通。

<img src="https://qcloudimg.tencent-cloud.cn/raw/d927b4cef24e59cd31fc564d0d202b9f.png" width="700"/>

（前端微信生态独有能力 + 后台云函数免运维托管服务）



微搭、云开发和云函数提供一站式的应用构建解决方案，通过以下的产品能力助力企业应用构建的效率，缩短研发周期，开发者只需聚焦于核心的业务价值：

- **高性能**

云开发环境承载小程序应用的接入层，云函数承载客户的业务逻辑 ，可以随着流量自动进行弹性伸缩，轻松支持万级 QPS 流量。

- **高扩展**

通过云函数承载业务逻辑、数据库存储、微信接口调用等功能，满足客户对于业务或者功能的定制化需求

- **开箱即用**

通过云函数打通云开发和公有云其他服务，复用现有的云上能力（BaaS），例如数据分析，音视频能力、图像处理能力等；同时提供了大量的应用构建模板降低开发者构建应用时的启动成本。

- **低代码**

微搭低代码提供高度开放的开发环境，将繁琐的底层架构和基础设施抽象化为图形界面，通过行业化模板、拖放式组件和可视化配置快速构建多端应用。

- **安全便捷**

同一个 VPC 网络内，无需对外暴露可以通过内网域名直接进行访问，也可以通过专线、云联网等方式打通云上和云下资源。

<img src="https://qcloudimg.tencent-cloud.cn/raw/0e7d6439400a78b0031c322f5c325591.png" width="700"/>

（四川天府健康通，高可用架构）



四川天府健康通小程序的开发和运行，不仅要快，更要稳定。在本次重大攻坚项目中，四川天府健康通在14天内如期上线，与传统开发模式相比，交付效率提升一倍，人力成本缩减一半。同时，春运期间，四川天府健康通 DUA 达到1500万，上线以来一直安全稳定运行，被誉为全国使用最广泛，运营最好的健康码产品之一。



## 02. 云函数+云开发+微搭，探索更多应用场景

**除了健康码之外，即将到来的双11 等大促场景，也有类似的痛点和需求。**近年来，微信小程序在电商战场表现亮眼，2020 年小程序年均 DAU 突破4亿，全年累计交易额同比增长超100%，商城小程序跃为社交电商的主阵地之一。

<img src="https://qcloudimg.tencent-cloud.cn/raw/5300903904619414a3b19e1fb82c2089.png" width="700"/>

（云函数助力小程序云开发：一键式云端部署，安全、高效、免运维）



作为底层算力，云函数助力云开发为开发者提供高可用、自动弹性扩缩的后端云服务，包含计算、存储、托管等 Serverless 化能力。在腾讯云产品的基础上，根据业务场景需要进行功能的整合与定制，更加贴近小程序 / Web 应用开发需求，帮助开发者统一构建和管理后端服务和云端资源，避免应用开发过程中繁琐的服务器搭建及运维，让开发者可以专注于业务逻辑的实现，降低开发门槛，提高开发效率。



每年大促期间，零售行业线上渠道都面临历史级别的流量挑战，中大型电商平台的峰值调用量可达上千万/分钟，面临高于日常 10-20 倍的流量压力。而日常运营活动中，例如精品秒杀、限时抢购等，电商平台也同样面临大流量高并发、波峰波谷用户流量明显分化的典型场景。对于研发团队而言，经常面临如下困扰：

- 开发周期短、业务定制化程度搞；
- 服务器资源的估算、准备和管理；
- 压测流程繁琐、大压力承载不足；

<img src="https://qcloudimg.tencent-cloud.cn/raw/eedd84d09d83bd12050d2676025d9d7f.png" width="700"/>

（ 云开发+云函数+微搭，弹性算力，平稳支撑活动大促 ）



**方案优势**

- **快速构建**

通过微搭 WeDa 简单的「拖拉拽」快速完成活动页面搭建，创意想法即刻实现，开发效率提高 3-5 倍以上。

- **超高并发**

可快速拉起 10w 并发实例，稳定支持瞬时超高流量涌入。

- **安全稳定**

提供微信安全网关、风控、私有链路、鉴权等能力守护安全，杜绝羊毛党，防范恶意攻击。

- **更低成本**

活动大促专属资源包服务配置，用完即停，降低核心服务资源投入。



### 云函数+云开发+微搭，营销大促云端一站式方案咨询

[**点击提交信息**](https://wj.qq.com/s2/9289148/f3cd/)，我们将在 1-3 个工作日内与您联系，沟通了解更多业务场景信息，为您提供更加匹配适合的套餐方案。



------



> **传送门：**
>
> - GitHub: [github.com/serverless](https://github.com/serverless/serverless/blob/master/README_CN.md)
> - 官网：[serverless.com](https://serverless.com/)

欢迎访问：[Serverless 中文网](https://serverlesscloud.cn/)，您可以在 [最佳实践](https://serverlesscloud.cn/best-practice) 里体验更多关于 Serverless 应用的开发！





